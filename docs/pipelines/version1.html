<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Version 1 - Bld book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">1.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="../pipelines/preface.html"><strong aria-hidden="true">2.</strong> Pipelines</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pipelines/version2.html"><strong aria-hidden="true">2.1.</strong> Version 2</a></li><li class="chapter-item expanded "><a href="../pipelines/version1.html" class="active"><strong aria-hidden="true">2.2.</strong> Version 1</a></li></ol></li><li class="chapter-item expanded "><a href="../configuration/preface.html"><strong aria-hidden="true">3.</strong> Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/preface.html"><strong aria-hidden="true">3.1.</strong> Server mode</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../configuration/server/running_a_server.html"><strong aria-hidden="true">3.1.1.</strong> Running a server</a></li><li class="chapter-item expanded "><a href="../configuration/server/authorization.html"><strong aria-hidden="true">3.1.2.</strong> Authorization</a></li><li class="chapter-item expanded "><a href="../configuration/server/tls.html"><strong aria-hidden="true">3.1.3.</strong> TLS</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../cli/preface.html"><strong aria-hidden="true">4.</strong> Command line interface</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cli/cat.html"><strong aria-hidden="true">4.1.</strong> Cat</a></li><li class="chapter-item expanded "><a href="../cli/check.html"><strong aria-hidden="true">4.2.</strong> Check</a></li><li class="chapter-item expanded "><a href="../cli/config.html"><strong aria-hidden="true">4.3.</strong> Config</a></li><li class="chapter-item expanded "><a href="../cli/cron.html"><strong aria-hidden="true">4.4.</strong> Cron</a></li><li class="chapter-item expanded "><a href="../cli/help.html"><strong aria-hidden="true">4.5.</strong> Help</a></li><li class="chapter-item expanded "><a href="../cli/hist.html"><strong aria-hidden="true">4.6.</strong> Hist</a></li><li class="chapter-item expanded "><a href="../cli/init.html"><strong aria-hidden="true">4.7.</strong> Init</a></li><li class="chapter-item expanded "><a href="../cli/login.html"><strong aria-hidden="true">4.8.</strong> Login</a></li><li class="chapter-item expanded "><a href="../cli/ls.html"><strong aria-hidden="true">4.9.</strong> Ls</a></li><li class="chapter-item expanded "><a href="../cli/monit.html"><strong aria-hidden="true">4.10.</strong> Monit</a></li><li class="chapter-item expanded "><a href="../cli/pull.html"><strong aria-hidden="true">4.11.</strong> Pull</a></li><li class="chapter-item expanded "><a href="../cli/push.html"><strong aria-hidden="true">4.12.</strong> Push</a></li><li class="chapter-item expanded "><a href="../cli/rm.html"><strong aria-hidden="true">4.13.</strong> Rm</a></li><li class="chapter-item expanded "><a href="../cli/run.html"><strong aria-hidden="true">4.14.</strong> Run</a></li><li class="chapter-item expanded "><a href="../cli/server.html"><strong aria-hidden="true">4.15.</strong> Server</a></li><li class="chapter-item expanded "><a href="../cli/stop.html"><strong aria-hidden="true">4.16.</strong> Stop</a></li><li class="chapter-item expanded "><a href="../cli/supervisor.html"><strong aria-hidden="true">4.17.</strong> Supervisor</a></li><li class="chapter-item expanded "><a href="../cli/worker.html"><strong aria-hidden="true">4.18.</strong> Worker</a></li></ol></li><li class="chapter-item expanded "><a href="../examples/preface.html"><strong aria-hidden="true">5.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../examples/dotnet-pipeline.html"><strong aria-hidden="true">5.1.</strong> .NET pipeline</a></li><li class="chapter-item expanded "><a href="../examples/nodejs-pipeline.html"><strong aria-hidden="true">5.2.</strong> Nodejs pipeline</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Bld book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="pipeline-v1-syntax"><a class="header" href="#pipeline-v1-syntax">Pipeline V1 syntax</a></h1>
<p>This page is dedicated in explaining the syntax of the version 1 pipeline files with examples.</p>
<h1 id="top-level-statements"><a class="header" href="#top-level-statements">Top level statements</a></h1>
<p>The list of top level sections for a pipeline are:</p>
<ul>
<li><strong>name</strong>(optional): A name that will be printed on the execution log.</li>
<li><strong>runs_on</strong>: The target run platform that can either be <code>machine</code> or the name of a docker image.</li>
<li><strong>version</strong>: The pipeline syntax version. This helps with backwards compatibility.</li>
<li><strong>dispose</strong>(optional): A boolean value that when set to true will not clean up after a run.
<ul>
<li>For machine runs a temporary directory is created under the <code>.bld/tmp/</code> path with a uuid directory for the run.</li>
<li>For container runs the container itself will not be stopped and removed.</li>
</ul>
</li>
<li><strong>variables</strong>(optional): An array of variables that can be used to dynamically replace sections of a step command.</li>
<li><strong>environment</strong>(optional): An array of environment variables that will be set when executing a step command.</li>
<li><strong>artifacts</strong>(optional): An array that can configure operations for sending or fetching artifacts from a <code>container</code>.</li>
<li><strong>external</strong>(optional): An array that can configure execution of other pipelines either in the same Bld instance or to a target server.</li>
<li><strong>steps</strong>: An array of command to execute, pipelines to call or invoke in a server.</li>
</ul>
<p>Let's take for example the below pipeline, with the file name example.yaml, that needs to run on the current <code>machine</code> and list all files in a directory</p>
<pre><code class="language-yaml">name: Example pipeline 1
runs_on: machine
working_dir: /home/user/target_directory
version: 1

steps:
- name: List all content of target_directory
  working_dir: /home/user/target_directory
  exec:
  - ls
</code></pre>
<h1 id="variables"><a class="header" href="#variables">Variables</a></h1>
<p>The variables section is a hashmap where the key is the variable name and the value is its default value. The value of a variable can be modified the user when running the pipeline.</p>
<p>Based on the previous example, that was rather specific, we could enhance our pipeline with a variable to either list the content of the target_directory or another one specified when using the <code>run</code> subcommand. Below is a configured pipeline with a variable</p>
<pre><code class="language-yaml">name: Example pipeline with variables 1
runs_on: machine
version: 1

variables:
  directory: /home/user/target_directory

steps:
- name: List all content of target_directory
  working_dir: bld:var:directory
  exec:
  - ls
</code></pre>
<p>Here we see the syntax for using a Bld variable, configuring its name and default value. It can be used with the <code>bld:var:</code> prefix and using the name <code>directory</code> for the variable name. You can run the pipeline normally and leave the value as is or you can use the <code>-v</code> or <code>--variable</code> option of the <code>run</code> subcommand</p>
<pre><code class="language-bash">$ bld run -p example.yaml -v directory=/home/kvl/another_directory
</code></pre>
<p>We can define multiple variables</p>
<pre><code class="language-yaml">name: Example pipeline with variables 2
runs_on: machine
version: 1

variables:
  first_directory: /home/user/target_directory
  second_directory: /home/user/another_directory
  third_directory: /home/user/yet_another_directory

steps:
- name: List content of all directories
  exec:
  - ls bld:var:first_directory
  - ls bld:var:second_directory
  - ls bld:var:third_directory
</code></pre>
<p>And set new values using the cli</p>
<pre><code class="language-bash">$ bld run -p example.yaml -v first_directory=some_path -v second_directory=some_other_path -v third_directory=some_yet_another_path
</code></pre>
<h1 id="environment-variables"><a class="header" href="#environment-variables">Environment variables</a></h1>
<p>Same with the variables section, the environment variables section is a hashmap where the key is the variable name and the value is its default value. The value of an environment variable can be modified the user when running the pipeline.</p>
<p>Just like with variables, they can used with the <code>bld:env:</code> prefix or use the syntax $ syntax.</p>
<pre><code class="language-yaml">name: Example pipeline with environment variables 1
runs_on: machine
version: 1

environment:
  first_directory: /home/user/target_directory
  second_directory: /home/user/another_directory

steps:
- name: List content of all directories
  exec:
  - ls bld:env:first_directory
  - ls $second_directory
</code></pre>
<p>And specify a different value using the <code>-e</code> or <code>--environment</code> of the <code>run</code> subcommand</p>
<pre><code class="language-bash">$ bld run -p example.yaml -e first_directory=some_path -e second_directory=some_other_path
</code></pre>
<h1 id="artifacts"><a class="header" href="#artifacts">Artifacts</a></h1>
<p>This section can be used to send or fetch files to or from a container created by a run. For example let say we create a pipeline that will create a file in an <code>ubuntu</code> container and then fetch it on the current machine.</p>
<pre><code class="language-yaml">name: Example pipeline for artifacts
runs_on: ubuntu
version: 1

steps:
- name: Create a sample file
  exec:
  - echo 'hello world' &gt; sample_file

artifacts:
- method: get
  from: /sample_file
  to: /home/user/some_directory
  after: Create a sample file
</code></pre>
<p>The artifacts section supports methods <code>get</code> to retrieve files and <code>push</code> to send files to the container. Additionally the <code>after</code> section can be omitted in order for the operation to execute before any step.</p>
<h1 id="external"><a class="header" href="#external">External</a></h1>
<p>The <code>external</code> section can used to declare information about another pipeline (either local or on a remote server) and be invoked by steps section. Let's see an example with a parent pipeline called <code>parent.yaml</code> that needs to execute a child pipeline called <code>child.yaml</code>.</p>
<pre><code class="language-yaml">pipeline: Parent pipeline
runs_on: ubuntu
version: 1

external:
- pipeline: child.yaml

steps:
- name: Do execute child
  exec:
  - ext: child.yaml
</code></pre>
<p>The above is the simplest form of executing another pipeline locally, but a server option can be provided if the run of the child pipeline needs to be done in another machine. Lets change the above example in order to invoke the child pipeline to a Bld server called <code>demo</code>.</p>
<pre><code class="language-yaml">pipeline: Parent pipeline
runs_on: ubuntu
version: 1

external:
- pipeline: child.yaml
  server: demo

steps:
- name: Do execute child
  exec:
  - ext: child.yaml
</code></pre>
<p>The <code>external</code> section can be configured to pass both variables and environment variables to the target pipeline. See the below example for configuring them</p>
<pre><code class="language-yaml">external:
- name: Execute child pipeline
  pipeline: child.yaml
  variables:
  - variable1: hello
  - variable2: world
  environment:
  - env1: hello world
</code></pre>
<p>Lets see all 3 ways that an external pipeline can be called. The first way is to simply call it in the exec part of a step.</p>
<pre><code class="language-yaml">runs_on: ubuntu
version: 1

steps:
- exec:
  - ext: child.yaml
</code></pre>
<p>The second way is to define a new entry to the external section for the pipeline. This will pick up any values for variables and environment variables are desired for the invokation.</p>
<pre><code class="language-yaml">runs_on: ubuntu
version: 1

external:
- pipeline: child.yaml
  variables:
    some-variable: an example value

steps:
- exec:
  - ext: child.yaml
</code></pre>
<p>The third way is to use a name in the external entries in order to have different declarations for the same pipeline.</p>
<pre><code class="language-yaml">runs_on: ubuntu
version: 1

external:
- name: Call child.yaml with a variable
  pipeline: child.yaml
  variables:
    some-variable: an example value

- name: Call child.yaml on a server
  pipeline: child.yaml
  server: demo_server
  variables:
    some-variable: an example value

steps:
- exec:
  - ext: Call child.yaml with a variable
  - ext: Call child.yaml on a server
</code></pre>
<h1 id="steps"><a class="header" href="#steps">Steps</a></h1>
<p>The <code>steps</code> section describes a set of commands to be executed or external pipelines to be invoked. Lets look at an example where there are multiple steps in a pipeline for listing contents of a directory, creating a sample file and using curl to see the IP address of the machine.</p>
<pre><code class="language-yaml">name: Example pipeline for multiple steps
runs_on: machine
version: 1

steps:
- name: List the content of directories
  exec:
  - ls ./some_directory
  - ls ./some_other_directory
  - ls ./yet_another_directory

- name: Create a sample file
  exec:
  - echo 'hello world' &gt; sample_file

- name: Curl IP address
  exec:
  - curl ifconfig.me
</code></pre>
<p>Let's consider now that the above pipeline was called <code>example-1.yaml</code> and we wanted all of its steps to be part of another pipeline called <code>example-2.yaml</code>, we could call the pipeline as shown below.</p>
<pre><code class="language-yaml">name: Example pipeline for calling another pipeline
runs_on: machine
version: 1

steps:
- name: Call another pipeline and list a directory
  exec:
  - ext: example-1.yaml
  - ls ./some_directory
</code></pre>
<p>You can use the <code>working_dir</code> option to change the target directory for a specific step as show below</p>
<pre><code class="language-yaml">name: Example pipeline
runs_on: ubuntu
version: 1

steps:
- name: First step
  working_dir: /some/working/directory
  exec:
  - ls ./subdirectory
  - rm ./subdirectory/file

- name: Second step
  working_dir: /another/working/directory
  exec:
  - ls ./some-other-dir/
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pipelines/version2.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../configuration/preface.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pipelines/version2.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../configuration/preface.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
