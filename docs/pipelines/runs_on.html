<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Runs on - Bld book</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">1.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="../configuration.html"><strong aria-hidden="true">2.</strong> Configuration</a></li><li class="chapter-item expanded "><a href="../pipelines/preface.html"><strong aria-hidden="true">3.</strong> Pipelines</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pipelines/version.html"><strong aria-hidden="true">3.1.</strong> Version</a></li><li class="chapter-item expanded "><a href="../pipelines/name.html"><strong aria-hidden="true">3.2.</strong> Name</a></li><li class="chapter-item expanded "><a href="../pipelines/runs_on.html" class="active"><strong aria-hidden="true">3.3.</strong> Runs on</a></li><li class="chapter-item expanded "><a href="../pipelines/cron.html"><strong aria-hidden="true">3.4.</strong> Cron</a></li><li class="chapter-item expanded "><a href="../pipelines/dispose.html"><strong aria-hidden="true">3.5.</strong> Dispose</a></li><li class="chapter-item expanded "><a href="../pipelines/variables.html"><strong aria-hidden="true">3.6.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../pipelines/environment.html"><strong aria-hidden="true">3.7.</strong> Envrironment</a></li><li class="chapter-item expanded "><a href="../pipelines/keywords.html"><strong aria-hidden="true">3.8.</strong> Keywords</a></li><li class="chapter-item expanded "><a href="../pipelines/artifacts.html"><strong aria-hidden="true">3.9.</strong> Artifacts</a></li><li class="chapter-item expanded "><a href="../pipelines/external.html"><strong aria-hidden="true">3.10.</strong> External</a></li><li class="chapter-item expanded "><a href="../pipelines/jobs_and_steps.html"><strong aria-hidden="true">3.11.</strong> Jobs and steps</a></li><li class="chapter-item expanded "><a href="../pipelines/validation.html"><strong aria-hidden="true">3.12.</strong> Validation</a></li></ol></li><li class="chapter-item expanded "><a href="../server/preface.html"><strong aria-hidden="true">4.</strong> Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/running_a_server.html"><strong aria-hidden="true">4.1.</strong> Running a server</a></li><li class="chapter-item expanded "><a href="../server/database.html"><strong aria-hidden="true">4.2.</strong> Database</a></li><li class="chapter-item expanded "><a href="../server/authorization.html"><strong aria-hidden="true">4.3.</strong> Authorization</a></li><li class="chapter-item expanded "><a href="../server/tls.html"><strong aria-hidden="true">4.4.</strong> TLS</a></li><li class="chapter-item expanded "><a href="../server/ssh.html"><strong aria-hidden="true">4.5.</strong> SSH</a></li><li class="chapter-item expanded "><a href="../server/ui/preface.html"><strong aria-hidden="true">4.6.</strong> User interface</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/ui/login.html"><strong aria-hidden="true">4.6.1.</strong> Login</a></li><li class="chapter-item expanded "><a href="../server/ui/dashboard.html"><strong aria-hidden="true">4.6.2.</strong> Dashboard</a></li><li class="chapter-item expanded "><a href="../server/ui/history.html"><strong aria-hidden="true">4.6.3.</strong> History</a></li><li class="chapter-item expanded "><a href="../server/ui/monitor.html"><strong aria-hidden="true">4.6.4.</strong> Monitor</a></li><li class="chapter-item expanded "><a href="../server/ui/pipelines.html"><strong aria-hidden="true">4.6.5.</strong> Pipelines</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/ui/pipelines_info.html"><strong aria-hidden="true">4.6.5.1.</strong> Info</a></li><li class="chapter-item expanded "><a href="../server/ui/pipelines_run.html"><strong aria-hidden="true">4.6.5.2.</strong> Run</a></li></ol></li><li class="chapter-item expanded "><a href="../server/ui/cron.html"><strong aria-hidden="true">4.6.6.</strong> Cron jobs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/ui/cron_info.html"><strong aria-hidden="true">4.6.6.1.</strong> Info</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../github-action.html"><strong aria-hidden="true">5.</strong> Github action</a></li><li class="chapter-item expanded "><a href="../cli/preface.html"><strong aria-hidden="true">6.</strong> Command line interface</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cli/cat.html"><strong aria-hidden="true">6.1.</strong> Cat</a></li><li class="chapter-item expanded "><a href="../cli/check.html"><strong aria-hidden="true">6.2.</strong> Check</a></li><li class="chapter-item expanded "><a href="../cli/config.html"><strong aria-hidden="true">6.3.</strong> Config</a></li><li class="chapter-item expanded "><a href="../cli/cp.html"><strong aria-hidden="true">6.4.</strong> Cp</a></li><li class="chapter-item expanded "><a href="../cli/cron.html"><strong aria-hidden="true">6.5.</strong> Cron</a></li><li class="chapter-item expanded "><a href="../cli/help.html"><strong aria-hidden="true">6.6.</strong> Help</a></li><li class="chapter-item expanded "><a href="../cli/hist.html"><strong aria-hidden="true">6.7.</strong> Hist</a></li><li class="chapter-item expanded "><a href="../cli/init.html"><strong aria-hidden="true">6.8.</strong> Init</a></li><li class="chapter-item expanded "><a href="../cli/login.html"><strong aria-hidden="true">6.9.</strong> Login</a></li><li class="chapter-item expanded "><a href="../cli/ls.html"><strong aria-hidden="true">6.10.</strong> Ls</a></li><li class="chapter-item expanded "><a href="../cli/monit.html"><strong aria-hidden="true">6.11.</strong> Monit</a></li><li class="chapter-item expanded "><a href="../cli/mv.html"><strong aria-hidden="true">6.12.</strong> Mv</a></li><li class="chapter-item expanded "><a href="../cli/pull.html"><strong aria-hidden="true">6.13.</strong> Pull</a></li><li class="chapter-item expanded "><a href="../cli/push.html"><strong aria-hidden="true">6.14.</strong> Push</a></li><li class="chapter-item expanded "><a href="../cli/rm.html"><strong aria-hidden="true">6.15.</strong> Rm</a></li><li class="chapter-item expanded "><a href="../cli/run.html"><strong aria-hidden="true">6.16.</strong> Run</a></li><li class="chapter-item expanded "><a href="../cli/server.html"><strong aria-hidden="true">6.17.</strong> Server</a></li><li class="chapter-item expanded "><a href="../cli/stop.html"><strong aria-hidden="true">6.18.</strong> Stop</a></li><li class="chapter-item expanded "><a href="../cli/supervisor.html"><strong aria-hidden="true">6.19.</strong> Supervisor</a></li><li class="chapter-item expanded "><a href="../cli/worker.html"><strong aria-hidden="true">6.20.</strong> Worker</a></li></ol></li><li class="chapter-item expanded "><a href="../examples/preface.html"><strong aria-hidden="true">7.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../examples/dotnet-pipeline.html"><strong aria-hidden="true">7.1.</strong> .NET pipeline</a></li><li class="chapter-item expanded "><a href="../examples/nodejs-pipeline.html"><strong aria-hidden="true">7.2.</strong> Nodejs pipeline</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Bld book</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="runs_on"><a class="header" href="#runs_on">Runs_on</a></h1>
<p>The <code>runs_on</code> field in the pipeline defines the platform of execution and currently the latest version of the pipeline syntax supports the below:</p>
<ul>
<li>machine</li>
<li>container</li>
<li>ssh connection</li>
</ul>
<h2 id="machine-platform"><a class="header" href="#machine-platform">Machine platform</a></h2>
<blockquote>
<p>Supported in pipeline versions: <code>version 1</code>, <code>version 2</code></p>
</blockquote>
<p>The machine platform indicates that all commands will be executed directly on the host machine. The bld runtime will also create a temporary directory in <code>.bld/tmp</code> path with a unique Uuid as a directory that can be used for the run which will be cleaned up afterwards.</p>
<p>To use the machine platform simply use the below top level statement.</p>
<pre><code class="language-yaml">runs_on: machine
</code></pre>
<h2 id="container-platform"><a class="header" href="#container-platform">Container platform</a></h2>
<p>The container platform is used so that commands defined in the pipeline are executed inside a docker container using an exec instance. The container platform supports various types of configuration.</p>
<h3 id="run-commands-on-existing-docker-images"><a class="header" href="#run-commands-on-existing-docker-images">Run commands on existing docker images</a></h3>
<blockquote>
<p>Supported in pipeline versions: <code>version 1</code>, <code>version 2</code></p>
</blockquote>
<p>To run commands on existing docker images. This option simply will try to create a new container at the start of the run based on the name of the provided image, if the image doesn't exist then the container won't be created. The user is responsible for maintaining the docker images in this case. As an example below we define this type of container platform for the latest ubuntu image.</p>
<pre><code class="language-yaml">runs_on: ubuntu
</code></pre>
<h3 id="run-commands-on-existing-or-missing-docker-images"><a class="header" href="#run-commands-on-existing-or-missing-docker-images">Run commands on existing or missing docker images</a></h3>
<blockquote>
<p>Supported in pipeline versions: <code>version 2</code></p>
</blockquote>
<p>This type of the container platform is similar to the previous one but it can define the option to pull the docker image when the run starts. If the pull option is active then the run will look up the image, pull it if neccessary and then start the run on the created container. As an example to define such platform for the ubuntu image you can use the below top level statement.</p>
<pre><code class="language-yaml">runs_on:
    image: ubuntu
    pull: true
</code></pre>
<p>To pull a specific image tag you can use the : notation similar to the example below.</p>
<pre><code class="language-yaml">runs_on:
    image: ubuntu:20.04
    pull: true
</code></pre>
<p>Optionally you can specify the docker url to be used for the pull operation based on the defined urls in the bld configuration file. Remember that the docker url is the name of the target url.</p>
<pre><code class="language-yaml">runs_on:
    image: ubuntu:20.04
    pull: true
    docker_url: unix_socket_docker_url
</code></pre>
<p>Last but not least you can define the docker registry to be used for the pull operation based on the defined registries in the bld configuration file or by setting a specific configuration for the pipeline.</p>
<pre><code class="language-yaml"># Look up the registry in the global configuration
runs_on:
    image: ubuntu:20.04
    pull: true
    registry: ghcr

# Define the registry in the pipeline configuration
runs_on:
    image: ubuntu:20.04
    pull: true
    registry:
        url: ghcr.io
        username: some_username
        password: some_password
</code></pre>
<h3 id="run-commands-on-images-built-from-a-dockerfile"><a class="header" href="#run-commands-on-images-built-from-a-dockerfile">Run commands on images built from a Dockerfile</a></h3>
<blockquote>
<p>Supported in pipeline versions: <code>version 2</code></p>
</blockquote>
<p>This type of container platform leverages a Dockerfile to build an image based on specified configuration and then run the provided commands on a new container created with this image. As an example to create such a platform use the below top level statement.</p>
<pre><code>runs_on:
    dockerfile: /path/to/dockerfile
    name: custom-image
    tag: latest
</code></pre>
<p>Optionally you can specify the docker url to be used for the pull operation based on the defined urls in the bld configuration file. Remember that the docker url is the name of the target url.</p>
<pre><code class="language-yaml">runs_on:
    dockerfile: /path/to/dockerfile
    name: custom-image
    tag: latest
    docker_url: unix_socket_docker_url
</code></pre>
<h2 id="ssh-platform"><a class="header" href="#ssh-platform">Ssh platform</a></h2>
<blockquote>
<p>Supported in pipeline versions: <code>version 2</code></p>
</blockquote>
<p>The ssh platform exists in order to make the execution of multiple commands over an ssh connection easier. A user could always directly use the <code>ssh</code> binary in a command that is executed in a diffferent platform.</p>
<p>An example of using this platform is shown below:</p>
<pre><code class="language-yaml">runs_on:
    host: 127.0.0.1
    port: 22
    user: some_user
    userauth:
        type: password
        password: the_user_password

</code></pre>
<p>Additionally you can define a global configuration for ssh connections in the <code>.bld/config.yaml</code> file and use the name of the configuration in the <code>runs_on</code> field as show below. See the <code>Server &gt; SSH</code> section for more information on the global configuration.</p>
<pre><code class="language-yaml">runs_on:
    ssh_config: my_global_ssh_config_key
</code></pre>
<p>Note here that this platform always expects the <code>host</code>, <code>user</code> and <code>userauth</code> fields with the <code>port</code> field being optional having a default value of <code>port: 22</code> if not provided. Additionally the <code>userauth</code> field has 3 types of authentication that can be defined.</p>
<h3 id="password-user-authentication"><a class="header" href="#password-user-authentication">Password user authentication</a></h3>
<p>The password authentication type for the ssh platform uses a password directly that is passed to the ssh connection when that is established. To define such user authentication you can use the below statement:</p>
<pre><code class="language-yaml">userauth:
    type: password
    password: the_user_password
</code></pre>
<h3 id="keys-user-authentication"><a class="header" href="#keys-user-authentication">Keys user authentication</a></h3>
<p>The keys authentication type uses a private and a public key when establishing the ssh connection, and such a configuration can be done using the below statement:</p>
<pre><code class="language-yaml">userauth:
    type: keys
    public_key: /path/to/public_key
    private_key: /path/to/private_key
</code></pre>
<p>The <code>private_key</code> field is mandatory but the <code>public_key</code> is optional.</p>
<h3 id="agent-user-authentication"><a class="header" href="#agent-user-authentication">Agent user authentication</a></h3>
<p>This type attemps to perform ssh agent authentication and can be configured using the below statement:</p>
<pre><code class="language-yaml">userauth:
    type: agent
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../pipelines/name.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../pipelines/cron.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../pipelines/name.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../pipelines/cron.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
